<div>
  <div class="pull-left">
    <span translate>search.coverage-group-by</span>
    <div class="btn-group" uib-dropdown is-open="status.isopen">
      <button type="button" class="btn btn-primary btn-sm" uib-dropdown-toggle ng-disabled="disabled">
        {{'search.coverage-buckets.' + bucket | translate}} <span class="caret"></span>
      </button>
      <ul uib-dropdown-menu role="menu">
        <li role="menuitem" ng-if="bucket !== BUCKET_TYPES.STUDYIDS">
          <a href ng-click="selectBucket(BUCKET_TYPES.STUDYIDS)" translate>search.coverage-buckets.studyIds</a>
        </li>
        <li role="menuitem" ng-if="bucket !== BUCKET_TYPES.DCEIDS">
          <a href ng-click="selectBucket(BUCKET_TYPES.DCEIDS)" translate>search.coverage-buckets.dceIds</a>
        </li>
        <li role="menuitem" ng-if="bucket !== BUCKET_TYPES.NETWORKID">
          <a href ng-click="selectBucket(BUCKET_TYPES.NETWORKID)" translate>search.coverage-buckets.networkId</a>
        </li>
      </ul>
    </div>
  </div>

  <div class="pull-right" ng-if="table.taxonomyHeaders.length > 0">
    <a target="_self" class="btn btn-info btn-responsive" ng-href="{{downloadUrl()}}">
      <i class="fa fa-download"></i> {{'download' | translate}}
    </a>
    <!--<a href ng-click="toggleMissing(false)" ng-if="showMissing" translate>search.coverage-hide-missing</a>-->
    <!--<a href ng-click="toggleMissing(true)" ng-if="!showMissing" translate>search.coverage-show-missing</a>-->
  </div>

  <div class="clearfix"></div>

  <p class="help-block" ng-if="!loading && !table.taxonomyHeaders" translate>search.no-coverage</p>

  <div ng-if="loading" class="loading"></div>

  <div class="table-responsive" ng-if="table.taxonomyHeaders.length > 0">


    <table class="table table-bordered table-striped">
      <thead>
      <tr>
        <th rowspan="2" colspan="{{table.cols.colSpan}}" translate>{{'search.coverage-buckets.' + bucket}}</th>
        <th ng-repeat="header in table.vocabularyHeaders" colspan="{{header.termsCount}}">
          <span
            uib-popover="{{header.entity.descriptions[0].value}}"
            popover-title="{{header.entity.titles[0].value}}"
            popover-placement="bottom"
            popover-trigger="mouseenter">
          {{header.entity.titles[0].value}}
            </span>
        </th>
      </tr>
      <tr>
        <th ng-repeat="header in table.termHeaders">
          <span
            uib-popover="{{header.entity.descriptions[0].value}}"
            popover-title="{{header.entity.titles[0].value}}"
            popover-placement="bottom"
            popover-trigger="mouseenter">
          {{header.entity.titles[0].value}}
            </span>
        </th>
      </tr>
      </thead>
      <tbody>

      <tr ng-repeat="row in table.rows" ng-if="showMissing || table.termHeaders.length == keys(row.hits).length">
        <td ng-repeat="col in table.cols.ids[row.value]" rowspan="{{col.rowSpan}}" ng-if="col.rowSpan > 0">
          <a href="{{col.url ? col.url : ''}}"
            uib-popover-html="col.description === col.title ? null : col.description"
            popover-title="{{col.title}}"
            popover-placement="bottom"
            popover-trigger="mouseenter">{{col.title}}</a>
        </td>
        <td ng-repeat="h in table.termHeaders">
          <span class="label label-info" ng-if="row.hits[$index]">{{row.hits[$index]}}</span>
          <span ng-if="!row.hits[$index]">0</span>
        </td>
      </tr>

      </tbody>
      <tfoot>
      <tr>
        <th colspan="{{table.cols.colSpan}}" translate>all</th>
        <th ng-repeat="header in table.termHeaders" title="{{header.entity.descriptions[0].value}}">
          {{header.hits}}
        </th>
      </tr>
      </tfoot>
    </table>
  </div>

  <!--<pre>-->
  <!--{{table.cols | json}}-->
  <!--</pre>-->
</div>